<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <script src="./jquery.js"></script>
	<script src="./survey.js"></script>
	<title>Искусство программирования</title>
	<link rel="shortcut icon" href="img/6.png" type="image/png">
	<link rel="stylesheet" href="css/style.css" type="text/css">
</head>
<body>	
		<aside>
			<nav>
				<ul class="aside-menu">
					<li><a href="index.html">Главная</a></li>
					<li><a href="theory.html">Теоретические материалы</a></li>
					<li><a href="articles.html">Статьи</a></li>
					<li><a href="tests.html">Проверка знаний</a></li>
				</ul>
			</nav>
		</aside>
		
		<section>
			<blockquote>
				<p>Машина должна работать, а человек — думать.</p>
				<cite>
					<i>Принцип IBM</i>
				</cite>
			</blockquote>
		</section>
		<section class="f">
            <div class="text2">
            <p>TLS — это один из наиболее часто встречающихся инструментов безопасности, используемых в интернете. Протокол активно работает со многими процессами сетевого взаимодействия: передачей файлов, <a href="https://vpnpro.com/vpn-basics/what-is-a-vpn/" rel="follow noopener noreferrer" data-wpel-link="external" target="_blank">VPN-подключением</a> (в некоторых реализациях для обмена ключами), службами обмена мгновенными сообщениями или IP-телефонией.</p>
            <p>Один из ключевых аспектов протокола — это рукопожатие. Именно о нём мы поговорим в этой статье.</p>
            <p class="stars icon-stars">***</p>
            <p>«Рукопожатие SSL/TLS» — это название этапа установки HTTPS-соединения. Большая часть работы, связанной с протоколом SSL/TLS, выполняется именно на этом этапе. В прошлом году <a href="https://www.thesslstore.com/blog/tls-1-3-approved/" data-wpel-link="external" target="_blank" rel="nofollow noopener noreferrer">IETF доработал TLS 1.3</a>, полностью обновив процесс рукопожатия.<br>
            В статье будут освещены два вида рукопожатия — для протоколов TLS 1.2 и TLS 1.3, которые мы рассмотрим, начиная с абстрактного уровня и постепенно углубляясь в особенности:</p>
            <ul>
            <li>согласование криптографических протоколов;</li>
            <li>аутентификация с помощью SSL-сертификата;</li>
            <li>генерация сеансового ключа.</li>
            </ul>
            <h3>Как происходит TLS-рукопожатие</h3>
            <p>В HTTPS-соединении участвуют две стороны: клиент (инициатор соединения, обычно веб-браузер) и сервер. Цель рукопожатия SSL/TLS — выполнить всю криптографическую работу для установки безопасного соединения, в том числе проверить подлинность используемого SSL-сертификата и сгенерировать ключ шифрования.</p>
            <h3>Согласование шифронабора</h3>
            <p>Каждое программное обеспечение уникально. Поэтому даже самые популярные веб-браузеры имеют различную функциональность. Аналогично и на стороне сервера — Windows Server, Apache и NGINX также отличаются друг от друга. Всё становится ещё сложнее, когда вы добавляете пользовательские конфигурации.</p>
            <p>Именно поэтому первый шаг TLS-рукопожатия — обмен информацией о своих возможностях между клиентом и сервером для дальнейшего выбора поддерживаемых криптографических функций.</p>
            <p>Как только клиент и сервер согласовывают используемый шифронабор, сервер отправляет клиенту свой SSL-сертификат.</p>
            <h3>Аутентификация</h3>
            <p>Получив сертификат, клиент проверяет его на подлинность. Это чрезвычайно важный шаг. Чтобы соединение было безопасным, нужно не только зашифровать данные, нужно ещё убедиться, что они отправляются на правильный веб-сайт. Сертификаты SSL/TLS обеспечивают эту аутентификацию, а то, как они это делают, зависит от используемого шифронабора.</p>
            <p><a class="lightbox" href="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png" style="float: none;"><img class="alignnone wp-image-114703 lazy-loaded" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png" data-lazy-type="image" data-src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png" alt="" width="155" height="156" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png 283w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-150x150.png 150w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-280x280.png 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-90x90.png 90w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-50x50.png 50w" data-srcset="" sizes="(max-width: 155px) 100vw, 155px"><noscript><img class="alignnone wp-image-114703" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png" alt="" width="155" height="156" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image16.png 283w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-150x150.png 150w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-280x280.png 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-90x90.png 90w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image16-50x50.png 50w" sizes="(max-width: 155px) 100vw, 155px" /></noscript></a></p>
            <p>Все доверенные SSL-сертификаты выпускаются центром сертификации (ЦС). ЦС должен следовать строгим правилам выдачи и проверки сертификатов, чтобы ему доверяли. Вы можете считать ЦС кем-то вроде нотариуса — его подпись значит, что данные в сертификате реальны.</p>
            <p>Во время аутентификационной части TLS-рукопожатия клиент выполняет несколько криптографически безопасных проверок с целью убедиться, что выданный сервером сертификат подлинный. Процесс включает в себя проверку цифровой подписи и того, выдан ли сертификат доверенным ЦС.</p>
            <p>На этом этапе клиент косвенно проверяет, принадлежит ли серверу закрытый ключ, связанный с сертификатом.</p>
            <p>В RSA, самой распространённой криптосистеме с открытым ключом, клиент с помощью открытого ключа шифрует случайные данные, которые будут использоваться для генерации сеансового ключа. Сервер сможет расшифровать и использовать эти данные, только если у него есть закрытый ключ, наличие которого обеспечивает подлинность стороны.</p>
            <p>Если используется другая криптосистема, алгоритм может измениться, но проверка другой стороны на подлинность всё равно останется.</p>
            <h3>Обмен ключами</h3>
            <p>Последняя часть TLS-рукопожатия включает создание «сеансового ключа», который фактически будет использоваться для защищённой связи.</p>
            <p>Сеансовые ключи являются «симметричными», то есть один и тот же ключ используется для шифрования и дешифрования.</p>
            <p>Симметричное шифрование производительнее, чем асимметричное, что делает его более подходящим для отправки данных по HTTPS-соединению. Точный метод генерации ключа зависит от выбранного шифронабора, два самых распространённых из них — RSA и Диффи-Хеллман.</p>
            <p><a class="lightbox" href="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg" style="float: none;"><img class="alignnone wp-image-114704 lazy-loaded" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg" data-lazy-type="image" data-src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg" alt="" width="154" height="154" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg 300w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-150x150.jpg 150w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-280x280.jpg 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-90x90.jpg 90w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-50x50.jpg 50w" data-srcset="" sizes="(max-width: 154px) 100vw, 154px"><noscript><img class="alignnone wp-image-114704" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg" alt="" width="154" height="154" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image23.jpg 300w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-150x150.jpg 150w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-280x280.jpg 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-90x90.jpg 90w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image23-50x50.jpg 50w" sizes="(max-width: 154px) 100vw, 154px" /></noscript></a></p>
            <p>Чтобы завершить рукопожатие, каждая сторона сообщает другой, что она выполнила всю необходимую работу, а затем проверяет контрольные суммы, чтобы убедиться, что рукопожатие произошло без какого-либо вмешательства или повреждения.</p>
            <p>Всё SSL-рукопожатие происходит за несколько сотен миллисекунд. Это первое, что произойдёт при HTTPS-соединении, даже до загрузки веб-страницы. После SSL-рукопожатия начинается зашифрованное и аутентифицированное HTTPS-соединение, и все данные, отправляемые и получаемые клиентом и сервером, защищены.</p>
            <p>Вплоть до TLS 1.3 каждый раз, когда вы посещали сайт, рукопожатие происходило заново. Рукопожатие TLS 1.3 поддерживает 0-RTT или нулевое время возобновления приёма-передачи, что значительно увеличивает скорость для вернувшегося посетителя.</p>
            <h2>Пошаговый процесс рукопожатия в TLS 1.2</h2>
            <p>Рассмотрим TLS-рукопожатие с использованием RSA подробнее. Использование алгоритма Диффи-Хеллмана будет описано ниже.</p>
            <p><a class="lightbox" href="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg" style="float: none;"><img class="alignnone size-full wp-image-114705 lazy-loaded" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg" data-lazy-type="image" data-src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg" alt="" width="947" height="1080" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg 947w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-246x280.jpg 246w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-670x764.jpg 670w" data-srcset="" sizes="(max-width: 947px) 100vw, 947px"><noscript><img class="alignnone size-full wp-image-114705" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg" alt="" width="947" height="1080" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-1.jpg 947w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-246x280.jpg 246w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image2-670x764.jpg 670w" sizes="(max-width: 947px) 100vw, 947px" /></noscript></a></p>
            <ol>
            <li>Первое сообщение называется «Client Hello». В этом сообщении перечислены возможности клиента, чтобы сервер мог выбрать шифронабор, который будет использовать для связи. Также сообщение включает в себя большое случайно выбранное простое число, называемое «случайным числом клиента».</li>
            <li>Сервер вежливо отвечает сообщением «Server Hello». Там он сообщает клиенту, какие параметры соединения были выбраны, и возвращает своё случайно выбранное простое число, называемое «случайным числом сервера». Если клиент и сервер не имеют общих шифронаборов, то соединение завершается неудачно.</li>
            <li>В сообщении «Certificate» сервер отправляет клиенту свою цепочку SSL-сертификатов, включающую в себя листовой и промежуточные сертификаты. Получив их, клиент выполняет несколько проверок для верификации сертификата. Клиент также должен убедиться, что сервер обладает закрытым ключом сертификата, что происходит в процессе обмена/генерации ключей.</li>
            <li>Это необязательное сообщение, необходимое только для определённых методов обмена ключами (например для алгоритма Диффи-Хеллмана), которые требуют от сервера дополнительные данные.</li>
            <li>Сообщение «Server Hello Done» уведомляет клиента, что сервер закончил передачу данных.</li>
            <li>Затем клиент участвует в создании сеансового ключа. Особенности этого шага зависят от метода обмена ключами, который был выбран в исходных сообщениях «Hello». Так как мы рассматриваем RSA, клиент сгенерирует случайную строку байтов, называемую секретом (pre-master secret), зашифрует её с помощью открытого ключа сервера и передаст обратно.</li>
            <li>Сообщение «Change Cipher Spec» позволяет другой стороне узнать, что сеансовый ключ сгенерирован и можно переключиться на зашифрованное соединение.</li>
            <li>Затем отправляется сообщение «Finished», означающее, что на стороне клиента рукопожатие завершено. С этого момента соединение защищено сессионным ключом. Сообщение содержит данные (MAC), с помощью которых можно убедиться, что рукопожатие не было подделано.</li>
            <li>Теперь сервер расшифровывает pre-master secret и вычисляет сеансовый ключ. Затем отправляет сообщение «Change Cipher Spec», чтобы уведомить, что он переключается на зашифрованное соединение.</li>
            <li>Сервер также отправляет сообщение «Finished», используя только что сгенерированный симметричный сеансовый ключ, и проверяет контрольную сумму для проверки целостности всего рукопожатия.</li>
            </ol>
            <p>После этих шагов SSL-рукопожатие завершено. У обеих сторон теперь есть сеансовый ключ, и они могут взаимодействовать через зашифрованное и аутентифицированное соединение.</p>
            <p>На этом этапе могут быть отправлены первые байты веб-приложения (данные, относящиеся к фактическому сервису, — HTML, Javascript и т. д.).</p>
            <h2>Пошаговый процесс рукопожатия в TLS 1.3</h2>
            <p>Рукопожатие TLS 1.3 значительно короче, чем его предшественник.</p>
            <p><a class="lightbox" href="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg" style="float: none;"><img class="alignnone size-full wp-image-114706 lazy-loaded" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg" data-lazy-type="image" data-src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg" alt="" width="1000" height="374" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg 1000w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1-280x105.jpg 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1-670x251.jpg 670w" data-srcset="" sizes="(max-width: 1000px) 100vw, 1000px"><noscript><img class="alignnone size-full wp-image-114706" src="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg" alt="" width="1000" height="374" srcset="https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1.jpg 1000w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1-280x105.jpg 280w, https://cdn.tproger.ru/wp-content/uploads/2019/07/image4-1-670x251.jpg 670w" sizes="(max-width: 1000px) 100vw, 1000px" /></noscript></a></p>
            <ol>
            <li>Как и в случае TLS 1.2, сообщение «Client Hello» запускает рукопожатие, но на этот раз оно содержит гораздо больше информации. TLS 1.3 сократил число поддерживаемых шифров с 37 до 5. Это значит, что клиент может угадать, какое соглашение о ключах или протокол обмена будет использоваться, поэтому в дополнение к сообщению отправляет свою часть общего ключа из предполагаемого протокола.</li>
            <li>Сервер ответит сообщением «Server Hello». Как и в рукопожатии 1.2, на этом этапе отправляется сертификат. Если клиент правильно угадал протокол шифрования с присоединёнными данными и сервер на него согласился, последний отправляет свою часть общего ключа, вычисляет сеансовый ключ и завершает передачу сообщением «Server Finished».</li>
            <li>Теперь, когда у клиента есть вся необходимая информация, он верифицирует SSL-сертификат и использует два общих ключа для вычисления своей копии сеансового ключа. Когда это сделано, он отправляет сообщение «Client Finished».</li>
            </ol>
            <h2>Вместо заключения</h2>
            <p>SSL/TLS-рукопожатие — это увлекательный процесс, который имеет ключевое значение для безопасного интернета, и всё же он происходит так быстро и незаметно, что большинство людей даже никогда не задумывается об этом.</p>
            <p>По крайней мере, пока что-то не пойдёт не так, как нужно.</p></div>	
		</section>
		
        <footer>Контакты:<a href=https://vk.com/id190903911>VK</a><a href=https://github.com/TELEUZI>Git</a>
        </footer>
</body>
</html>
